MODEL (
  name intermediate.int_game_momentum_features,
  kind INCREMENTAL_BY_TIME_RANGE (
    time_column game_date,
    batch_size 90  -- 3 months per batch; now much faster since we just join 5 pre-computed groups
  ),
  start '1946-11-01',
  grains [game_id],
  cron '@daily',
  description 'Combined momentum features - joins 5 pre-computed feature groups for efficient computation'
);

-- This model joins 5 pre-computed feature groups instead of 50+ individual models.
-- Each group is materialized independently, making backfills much faster.
--
-- Feature Groups:
--   1. int_momentum_group_basic: streaks, rest, fatigue, weighted momentum (7 upstream models)
--   2. int_momentum_group_h2h: head-to-head, rivalry (3 upstream models)
--   3. int_momentum_group_opponent: opponent quality, tiers (8 upstream models)
--   4. int_momentum_group_context: home/away, clutch, season timing (14 upstream models)
--   5. int_momentum_group_trends: trends, acceleration, consistency, matchup (14 upstream models)

SELECT 
  -- Core identifiers
  b.game_id,
  b.game_date,
  b.home_team_id,
  b.away_team_id,
  
  -- ============================================
  -- GROUP 1: BASIC MOMENTUM (streaks, rest, fatigue)
  -- ============================================
  b.home_win_streak,
  b.home_loss_streak,
  b.away_win_streak,
  b.away_loss_streak,
  b.home_momentum_score,
  b.away_momentum_score,
  b.home_win_streak_quality,
  b.away_win_streak_quality,
  b.win_streak_quality_diff,
  b.home_rest_days,
  b.home_back_to_back,
  b.home_back_to_back_with_travel,
  b.home_btb_travel_count_5,
  b.home_btb_travel_count_10,
  b.home_travel_fatigue_score_5,
  b.away_rest_days,
  b.away_back_to_back,
  b.away_back_to_back_with_travel,
  b.away_btb_travel_count_5,
  b.away_btb_travel_count_10,
  b.away_travel_fatigue_score_5,
  b.back_to_back_travel_advantage,
  b.rest_advantage,
  b.btb_travel_count_5_diff,
  b.btb_travel_count_10_diff,
  b.travel_fatigue_score_5_diff,
  b.home_games_in_last_7_days,
  b.home_games_in_last_10_days,
  b.home_games_in_last_14_days,
  b.home_avg_rest_days_last_7_days,
  b.home_avg_rest_days_last_10_days,
  b.home_game_density_7_days,
  b.home_game_density_10_days,
  b.away_games_in_last_7_days,
  b.away_games_in_last_10_days,
  b.away_games_in_last_14_days,
  b.away_avg_rest_days_last_7_days,
  b.away_avg_rest_days_last_10_days,
  b.away_game_density_7_days,
  b.away_game_density_10_days,
  b.games_in_last_7_days_diff,
  b.games_in_last_10_days_diff,
  b.games_in_last_14_days_diff,
  b.avg_rest_days_last_7_days_diff,
  b.avg_rest_days_last_10_days_diff,
  b.game_density_7_days_diff,
  b.game_density_10_days_diff,
  b.home_weighted_momentum_5,
  b.home_weighted_momentum_10,
  b.away_weighted_momentum_5,
  b.away_weighted_momentum_10,
  b.weighted_momentum_diff_5,
  b.weighted_momentum_diff_10,
  b.home_weighted_win_streak,
  b.home_weighted_loss_streak,
  b.home_win_streak_avg_opponent_quality,
  b.home_loss_streak_avg_opponent_quality,
  b.away_weighted_win_streak,
  b.away_weighted_loss_streak,
  b.away_win_streak_avg_opponent_quality,
  b.away_loss_streak_avg_opponent_quality,
  b.home_exp_weighted_win_pct_10,
  b.home_exp_weighted_point_diff_10,
  b.home_exp_weighted_ppg_10,
  b.home_exp_weighted_opp_ppg_10,
  b.home_exp_weighted_win_pct_5,
  b.home_exp_weighted_point_diff_5,
  b.away_exp_weighted_win_pct_10,
  b.away_exp_weighted_point_diff_10,
  b.away_exp_weighted_ppg_10,
  b.away_exp_weighted_opp_ppg_10,
  b.away_exp_weighted_win_pct_5,
  b.away_exp_weighted_point_diff_5,
  b.exp_weighted_win_pct_diff_10,
  b.exp_weighted_point_diff_diff_10,
  b.exp_weighted_ppg_diff_10,
  b.exp_weighted_opp_ppg_diff_10,
  b.exp_weighted_win_pct_diff_5,
  b.exp_weighted_point_diff_diff_5,
  
  -- ============================================
  -- GROUP 2: HEAD-TO-HEAD & RIVALRY
  -- ============================================
  h.home_h2h_win_pct,
  h.home_h2h_recent_wins,
  h.home_h2h_win_pct_3,
  h.home_h2h_win_pct_5,
  h.home_h2h_avg_point_diff_3,
  h.home_h2h_avg_point_diff_5,
  h.home_h2h_momentum,
  h.rivalry_total_matchups,
  h.rivalry_recent_matchups,
  h.rivalry_avg_point_margin,
  h.rivalry_close_game_pct,
  h.rivalry_very_close_game_pct,
  h.rivalry_recent_close_game_pct,
  h.rivalry_recent_avg_margin,
  h.home_vs_opponent_home_win_pct,
  h.home_vs_opponent_home_games,
  h.home_vs_opponent_home_avg_point_diff,
  h.home_vs_opponent_away_win_pct,
  h.home_vs_opponent_away_games,
  h.home_vs_opponent_away_avg_point_diff,
  h.away_vs_opponent_home_win_pct,
  h.away_vs_opponent_home_games,
  h.away_vs_opponent_home_avg_point_diff,
  h.away_vs_opponent_away_win_pct,
  h.away_vs_opponent_away_games,
  h.away_vs_opponent_away_avg_point_diff,
  h.opponent_specific_win_pct_diff,
  h.opponent_specific_avg_point_diff_diff,
  
  -- ============================================
  -- GROUP 3: OPPONENT QUALITY & TIER
  -- ============================================
  o.home_recent_opp_avg_win_pct,
  o.away_recent_opp_avg_win_pct,
  o.home_performance_vs_quality,
  o.away_performance_vs_quality,
  o.home_sos_5_rolling,
  o.away_sos_5_rolling,
  o.home_sos_10_rolling,
  o.away_sos_10_rolling,
  o.home_sos_5_weighted,
  o.away_sos_5_weighted,
  o.home_win_pct_vs_opponent_tier,
  o.home_avg_point_diff_vs_opponent_tier,
  o.home_game_count_vs_opponent_tier,
  o.away_win_pct_vs_opponent_tier,
  o.away_avg_point_diff_vs_opponent_tier,
  o.away_game_count_vs_opponent_tier,
  o.win_pct_vs_opponent_tier_diff,
  o.avg_point_diff_vs_opponent_tier_diff,
  o.home_win_pct_vs_opponent_tier_at_home,
  o.home_avg_point_diff_vs_opponent_tier_at_home,
  o.home_game_count_vs_opponent_tier_at_home,
  o.home_win_pct_vs_opponent_tier_on_road,
  o.home_avg_point_diff_vs_opponent_tier_on_road,
  o.home_game_count_vs_opponent_tier_on_road,
  o.away_win_pct_vs_opponent_tier_at_home,
  o.away_avg_point_diff_vs_opponent_tier_at_home,
  o.away_game_count_vs_opponent_tier_at_home,
  o.away_win_pct_vs_opponent_tier_on_road,
  o.away_avg_point_diff_vs_opponent_tier_on_road,
  o.away_game_count_vs_opponent_tier_on_road,
  o.win_pct_vs_opponent_tier_home_away_diff,
  o.avg_point_diff_vs_opponent_tier_home_away_diff,
  o.home_win_pct_vs_strong_by_rest,
  o.home_games_vs_strong_by_rest,
  o.home_win_pct_vs_weak_by_rest,
  o.home_games_vs_weak_by_rest,
  o.away_win_pct_vs_strong_by_rest,
  o.away_games_vs_strong_by_rest,
  o.away_win_pct_vs_weak_by_rest,
  o.away_games_vs_weak_by_rest,
  o.win_pct_vs_strong_by_rest_diff,
  o.win_pct_vs_weak_by_rest_diff,
  o.home_win_pct_vs_similar_quality,
  o.home_avg_point_diff_vs_similar_quality,
  o.home_similar_quality_game_count,
  o.away_win_pct_vs_similar_quality,
  o.away_avg_point_diff_vs_similar_quality,
  o.away_similar_quality_game_count,
  o.is_current_game_similar_quality,
  o.win_pct_vs_similar_quality_diff,
  o.avg_point_diff_vs_similar_quality_diff,
  o.home_avg_opponent_strength_in_wins_5,
  o.home_avg_opponent_strength_in_losses_5,
  o.home_avg_opponent_strength_5,
  o.home_quality_adjusted_win_pct_5,
  o.home_avg_point_diff_in_wins_5,
  o.home_avg_point_diff_in_losses_5,
  o.home_wins_count_5,
  o.home_losses_count_5,
  o.home_total_games_5,
  o.home_avg_opponent_strength_in_wins_10,
  o.home_avg_opponent_strength_in_losses_10,
  o.home_avg_opponent_strength_10,
  o.home_quality_adjusted_win_pct_10,
  o.home_avg_point_diff_in_wins_10,
  o.home_avg_point_diff_in_losses_10,
  o.home_wins_count_10,
  o.home_losses_count_10,
  o.home_total_games_10,
  o.away_avg_opponent_strength_in_wins_5,
  o.away_avg_opponent_strength_in_losses_5,
  o.away_avg_opponent_strength_5,
  o.away_quality_adjusted_win_pct_5,
  o.away_avg_point_diff_in_wins_5,
  o.away_avg_point_diff_in_losses_5,
  o.away_wins_count_5,
  o.away_losses_count_5,
  o.away_total_games_5,
  o.away_avg_opponent_strength_in_wins_10,
  o.away_avg_opponent_strength_in_losses_10,
  o.away_avg_opponent_strength_10,
  o.away_quality_adjusted_win_pct_10,
  o.away_avg_point_diff_in_wins_10,
  o.away_avg_point_diff_in_losses_10,
  o.away_wins_count_10,
  o.away_losses_count_10,
  o.away_total_games_10,
  o.quality_adjusted_win_pct_diff_5,
  o.quality_adjusted_win_pct_diff_10,
  o.avg_opponent_strength_diff_5,
  o.avg_opponent_strength_diff_10,
  o.home_win_pct_vs_similar_opponents,
  o.home_similar_opponent_game_count,
  o.home_avg_point_diff_vs_similar_opponents,
  o.away_win_pct_vs_similar_opponents,
  o.away_similar_opponent_game_count,
  o.away_avg_point_diff_vs_similar_opponents,
  o.current_game_similarity_score,
  o.win_pct_vs_similar_opponents_diff,
  o.avg_point_diff_vs_similar_opponents_diff,
  o.home_weighted_win_pct_5,
  o.home_weighted_win_pct_10,
  o.home_weighted_point_diff_5,
  o.home_weighted_point_diff_10,
  o.home_weighted_net_rtg_5,
  o.home_weighted_net_rtg_10,
  o.away_weighted_win_pct_5,
  o.away_weighted_win_pct_10,
  o.away_weighted_point_diff_5,
  o.away_weighted_point_diff_10,
  o.away_weighted_net_rtg_5,
  o.away_weighted_net_rtg_10,
  o.weighted_win_pct_diff_5,
  o.weighted_win_pct_diff_10,
  o.weighted_point_diff_diff_5,
  o.weighted_point_diff_diff_10,
  o.weighted_net_rtg_diff_5,
  o.weighted_net_rtg_diff_10,
  
  -- ============================================
  -- GROUP 4: GAME CONTEXT (home/away, clutch, season)
  -- ============================================
  c.home_home_win_pct,
  c.away_road_win_pct,
  c.home_advantage,
  c.home_win_pct_vs_strong,
  c.home_win_pct_vs_weak,
  c.away_win_pct_vs_strong,
  c.away_win_pct_vs_weak,
  c.home_win_pct_by_rest_bucket,
  c.away_win_pct_by_rest_bucket,
  c.rest_bucket_win_pct_diff,
  c.home_clutch_win_pct,
  c.home_clutch_game_count,
  c.home_clutch_avg_point_diff,
  c.away_clutch_win_pct,
  c.away_clutch_game_count,
  c.away_clutch_avg_point_diff,
  c.home_blowout_win_pct,
  c.home_blowout_game_count,
  c.home_blowout_avg_point_diff,
  c.home_blowout_frequency,
  c.away_blowout_win_pct,
  c.away_blowout_game_count,
  c.away_blowout_avg_point_diff,
  c.away_blowout_frequency,
  c.blowout_win_pct_diff,
  c.blowout_avg_point_diff_diff,
  c.blowout_frequency_diff,
  c.home_comeback_win_pct,
  c.home_comeback_game_count,
  c.home_comeback_avg_point_diff,
  c.home_closeout_win_pct,
  c.home_closeout_game_count,
  c.home_closeout_avg_point_diff,
  c.away_comeback_win_pct,
  c.away_comeback_game_count,
  c.away_comeback_avg_point_diff,
  c.away_closeout_win_pct,
  c.away_closeout_game_count,
  c.away_closeout_avg_point_diff,
  c.comeback_win_pct_diff,
  c.closeout_win_pct_diff,
  c.comeback_avg_point_diff_diff,
  c.closeout_avg_point_diff_diff,
  c.home_overtime_win_pct,
  c.home_overtime_game_count,
  c.home_overtime_avg_point_diff,
  c.away_overtime_win_pct,
  c.away_overtime_game_count,
  c.away_overtime_avg_point_diff,
  c.home_rolling_5_q4_ppg,
  c.home_rolling_5_q4_net_rtg,
  c.home_rolling_5_q4_win_pct,
  c.home_rolling_10_q4_ppg,
  c.home_rolling_10_q4_net_rtg,
  c.home_rolling_10_q4_win_pct,
  c.home_season_q4_win_pct_when_won_q4,
  c.home_q4_wins_count_season,
  c.away_rolling_5_q4_ppg,
  c.away_rolling_5_q4_net_rtg,
  c.away_rolling_5_q4_win_pct,
  c.away_rolling_10_q4_ppg,
  c.away_rolling_10_q4_net_rtg,
  c.away_rolling_10_q4_win_pct,
  c.away_season_q4_win_pct_when_won_q4,
  c.away_q4_wins_count_season,
  c.home_avg_margin_in_wins_5,
  c.home_avg_margin_in_losses_5,
  c.home_close_game_win_pct_5,
  c.home_blowout_game_win_pct_5,
  c.home_avg_margin_in_wins_10,
  c.home_avg_margin_in_losses_10,
  c.home_close_game_win_pct_10,
  c.home_blowout_game_win_pct_10,
  c.away_avg_margin_in_wins_5,
  c.away_avg_margin_in_losses_5,
  c.away_close_game_win_pct_5,
  c.away_blowout_game_win_pct_5,
  c.away_avg_margin_in_wins_10,
  c.away_avg_margin_in_losses_10,
  c.away_close_game_win_pct_10,
  c.away_blowout_game_win_pct_10,
  c.home_favorite_win_pct,
  c.home_favorite_game_count,
  c.home_underdog_win_pct,
  c.home_underdog_game_count_upset,
  c.home_upset_resistance_score,
  c.away_favorite_win_pct,
  c.away_favorite_game_count,
  c.away_underdog_win_pct,
  c.away_underdog_game_count_upset,
  c.away_upset_resistance_score,
  c.home_win_pct_when_favored,
  c.home_favored_game_count,
  c.home_win_pct_when_underdog,
  c.home_underdog_game_count,
  c.home_avg_point_diff_when_favored,
  c.home_avg_point_diff_when_underdog,
  c.home_upset_rate,
  c.home_upset_game_count,
  c.away_win_pct_when_favored,
  c.away_favored_game_count,
  c.away_win_pct_when_underdog,
  c.away_underdog_game_count,
  c.away_avg_point_diff_when_favored,
  c.away_avg_point_diff_when_underdog,
  c.away_upset_rate,
  c.away_upset_game_count,
  c.win_pct_when_favored_diff,
  c.win_pct_when_underdog_diff,
  c.avg_point_diff_when_favored_diff,
  c.avg_point_diff_when_underdog_diff,
  c.upset_rate_diff,
  c.away_recent_road_win_pct_5,
  c.away_recent_road_game_count_5,
  c.away_recent_road_avg_point_diff_5,
  c.away_recent_road_win_pct_10,
  c.away_recent_road_game_count_10,
  c.away_recent_road_avg_point_diff_10,
  c.home_early_season_win_pct,
  c.home_early_season_game_count,
  c.home_early_season_avg_point_diff,
  c.home_mid_season_win_pct,
  c.home_mid_season_game_count,
  c.home_mid_season_avg_point_diff,
  c.home_late_season_win_pct,
  c.home_late_season_game_count,
  c.home_late_season_avg_point_diff,
  c.home_playoff_push_win_pct,
  c.home_playoff_push_game_count,
  c.home_playoff_push_avg_point_diff,
  c.is_home_early_season,
  c.is_home_mid_season,
  c.is_home_late_season,
  c.is_home_playoff_push,
  c.away_early_season_win_pct,
  c.away_early_season_game_count,
  c.away_early_season_avg_point_diff,
  c.away_mid_season_win_pct,
  c.away_mid_season_game_count,
  c.away_mid_season_avg_point_diff,
  c.away_late_season_win_pct,
  c.away_late_season_game_count,
  c.away_late_season_avg_point_diff,
  c.away_playoff_push_win_pct,
  c.away_playoff_push_game_count,
  c.away_playoff_push_avg_point_diff,
  c.is_away_early_season,
  c.is_away_mid_season,
  c.is_away_late_season,
  c.is_away_playoff_push,
  c.early_season_win_pct_diff,
  c.early_season_avg_point_diff_diff,
  c.mid_season_win_pct_diff,
  c.mid_season_avg_point_diff_diff,
  c.late_season_win_pct_diff,
  c.late_season_avg_point_diff_diff,
  c.playoff_push_win_pct_diff,
  c.playoff_push_avg_point_diff_diff,
  c.home_playoff_rank,
  c.home_is_in_playoff_position,
  c.home_games_back_from_cutoff,
  c.home_win_pct_diff_from_cutoff,
  c.home_is_close_to_cutoff,
  c.home_is_fighting_for_playoff_spot,
  c.away_playoff_rank,
  c.away_is_in_playoff_position,
  c.away_games_back_from_cutoff,
  c.away_win_pct_diff_from_cutoff,
  c.away_is_close_to_cutoff,
  c.away_is_fighting_for_playoff_spot,
  
  -- ============================================
  -- GROUP 5: TRENDS & MATCHUP
  -- ============================================
  -- Form divergence (aliased to match original column names)
  t.home_win_pct_divergence_5,
  t.home_win_pct_divergence_10,
  t.away_win_pct_divergence_5,
  t.away_win_pct_divergence_10,
  t.home_net_rtg_divergence_5,
  t.home_net_rtg_divergence_10,
  t.away_net_rtg_divergence_5,
  t.away_net_rtg_divergence_10,
  t.home_ppg_divergence_5,
  t.home_ppg_divergence_10,
  t.away_ppg_divergence_5,
  t.away_ppg_divergence_10,
  t.home_opp_ppg_divergence_5,
  t.home_opp_ppg_divergence_10,
  t.away_opp_ppg_divergence_5,
  t.away_opp_ppg_divergence_10,
  -- Use net_rtg_divergence as proxy for off/def (matching original model)
  t.home_net_rtg_divergence_5 AS home_off_rtg_divergence_5,
  t.home_net_rtg_divergence_10 AS home_off_rtg_divergence_10,
  t.away_net_rtg_divergence_5 AS away_off_rtg_divergence_5,
  t.away_net_rtg_divergence_10 AS away_off_rtg_divergence_10,
  t.home_net_rtg_divergence_5 AS home_def_rtg_divergence_5,
  t.home_net_rtg_divergence_10 AS home_def_rtg_divergence_10,
  t.away_net_rtg_divergence_5 AS away_def_rtg_divergence_5,
  t.away_net_rtg_divergence_10 AS away_def_rtg_divergence_10,
  t.home_form_divergence_magnitude_win_pct_5,
  t.home_form_divergence_magnitude_win_pct_10,
  t.away_form_divergence_magnitude_win_pct_5,
  t.away_form_divergence_magnitude_win_pct_10,
  -- Also include the original form_divergence names for backwards compatibility
  t.home_win_pct_divergence_5 AS home_form_divergence_win_pct_5,
  t.home_win_pct_divergence_10 AS home_form_divergence_win_pct_10,
  t.away_win_pct_divergence_5 AS away_form_divergence_win_pct_5,
  t.away_win_pct_divergence_10 AS away_form_divergence_win_pct_10,
  t.home_ppg_divergence_5 AS home_form_divergence_ppg_5,
  t.home_ppg_divergence_10 AS home_form_divergence_ppg_10,
  t.away_ppg_divergence_5 AS away_form_divergence_ppg_5,
  t.away_ppg_divergence_10 AS away_form_divergence_ppg_10,
  t.home_opp_ppg_divergence_5 AS home_form_divergence_opp_ppg_5,
  t.home_opp_ppg_divergence_10 AS home_form_divergence_opp_ppg_10,
  t.away_opp_ppg_divergence_5 AS away_form_divergence_opp_ppg_5,
  t.away_opp_ppg_divergence_10 AS away_form_divergence_opp_ppg_10,
  t.home_net_rtg_divergence_5 AS home_form_divergence_net_rtg_5,
  t.home_net_rtg_divergence_10 AS home_form_divergence_net_rtg_10,
  t.away_net_rtg_divergence_5 AS away_form_divergence_net_rtg_5,
  t.away_net_rtg_divergence_10 AS away_form_divergence_net_rtg_10,
  -- Performance trends
  t.home_win_pct_trend,
  t.home_net_rtg_trend,
  t.home_ppg_trend,
  t.home_off_rtg_trend,
  t.home_efg_pct_trend,
  t.home_ts_pct_trend,
  t.home_opp_ppg_trend,
  t.home_def_rtg_trend,
  t.away_win_pct_trend,
  t.away_net_rtg_trend,
  t.away_ppg_trend,
  t.away_off_rtg_trend,
  t.away_efg_pct_trend,
  t.away_ts_pct_trend,
  t.away_opp_ppg_trend,
  t.away_def_rtg_trend,
  -- Recent momentum
  t.home_recent_win_pct_momentum,
  t.home_recent_net_rtg_momentum,
  t.home_recent_ppg_momentum,
  t.home_recent_off_rtg_momentum,
  t.home_recent_efg_pct_momentum,
  t.home_recent_ts_pct_momentum,
  t.home_recent_opp_ppg_momentum,
  t.home_recent_def_rtg_momentum,
  t.away_recent_win_pct_momentum,
  t.away_recent_net_rtg_momentum,
  t.away_recent_ppg_momentum,
  t.away_recent_off_rtg_momentum,
  t.away_recent_efg_pct_momentum,
  t.away_recent_ts_pct_momentum,
  t.away_recent_opp_ppg_momentum,
  t.away_recent_def_rtg_momentum,
  -- Recent form trend
  t.home_form_trend_win_pct,
  t.home_form_trend_point_diff,
  t.away_form_trend_win_pct,
  t.away_form_trend_point_diff,
  t.form_trend_win_pct_diff,
  t.form_trend_point_diff_diff,
  -- Momentum acceleration
  t.home_momentum_acceleration,
  t.away_momentum_acceleration,
  t.momentum_acceleration_diff,
  -- Performance acceleration
  t.home_win_pct_acceleration,
  t.home_point_diff_acceleration,
  t.home_ppg_acceleration,
  t.home_defensive_acceleration,
  t.home_net_rtg_acceleration,
  t.away_win_pct_acceleration,
  t.away_point_diff_acceleration,
  t.away_ppg_acceleration,
  t.away_defensive_acceleration,
  t.away_net_rtg_acceleration,
  t.win_pct_acceleration_diff,
  t.point_diff_acceleration_diff,
  t.ppg_acceleration_diff,
  t.defensive_acceleration_diff,
  t.net_rtg_acceleration_diff,
  -- Performance consistency
  t.home_win_consistency_10,
  t.home_point_diff_consistency_10,
  t.home_points_consistency_10,
  t.home_opp_points_consistency_10,
  t.home_points_cv_10,
  t.home_opp_points_cv_10,
  t.home_win_consistency_5,
  t.home_point_diff_consistency_5,
  t.home_points_consistency_5,
  t.home_opp_points_consistency_5,
  t.home_points_cv_5,
  t.home_opp_points_cv_5,
  t.away_win_consistency_10,
  t.away_point_diff_consistency_10,
  t.away_points_consistency_10,
  t.away_opp_points_consistency_10,
  t.away_points_cv_10,
  t.away_opp_points_cv_10,
  t.away_win_consistency_5,
  t.away_point_diff_consistency_5,
  t.away_points_consistency_5,
  t.away_opp_points_consistency_5,
  t.away_points_cv_5,
  t.away_opp_points_cv_5,
  t.win_consistency_10_diff,
  t.point_diff_consistency_10_diff,
  t.points_consistency_10_diff,
  t.opp_points_consistency_10_diff,
  t.points_cv_10_diff,
  t.opp_points_cv_10_diff,
  t.win_consistency_5_diff,
  t.point_diff_consistency_5_diff,
  t.points_consistency_5_diff,
  t.opp_points_consistency_5_diff,
  t.points_cv_5_diff,
  t.opp_points_cv_5_diff,
  -- Matchup style performance
  t.home_win_pct_vs_fast_paced,
  t.home_win_pct_vs_slow_paced,
  t.home_win_pct_vs_high_scoring,
  t.home_win_pct_vs_defensive,
  t.away_win_pct_vs_fast_paced,
  t.away_win_pct_vs_slow_paced,
  t.away_win_pct_vs_high_scoring,
  t.away_win_pct_vs_defensive,
  -- Similar momentum performance
  t.home_win_pct_vs_similar_momentum,
  t.home_avg_point_diff_vs_similar_momentum,
  t.home_similar_momentum_game_count,
  t.away_win_pct_vs_similar_momentum,
  t.away_avg_point_diff_vs_similar_momentum,
  t.away_similar_momentum_game_count,
  t.is_current_game_similar_momentum,
  t.win_pct_vs_similar_momentum_diff,
  t.avg_point_diff_vs_similar_momentum_diff,
  -- Similar rest performance
  t.home_win_pct_vs_similar_rest,
  t.home_avg_point_diff_vs_similar_rest,
  t.home_similar_rest_game_count,
  t.away_win_pct_vs_similar_rest,
  t.away_avg_point_diff_vs_similar_rest,
  t.away_similar_rest_game_count,
  t.is_current_game_similar_rest_context,
  t.win_pct_vs_similar_rest_diff,
  t.avg_point_diff_vs_similar_rest_diff,
  -- Rest advantage scenarios
  t.home_win_pct_well_rested_vs_tired,
  t.home_avg_point_diff_well_rested_vs_tired,
  t.home_well_rested_vs_tired_count,
  t.home_win_pct_well_rested_vs_moderate,
  t.home_avg_point_diff_well_rested_vs_moderate,
  t.home_well_rested_vs_moderate_count,
  t.home_win_pct_moderate_vs_tired,
  t.home_avg_point_diff_moderate_vs_tired,
  t.home_moderate_vs_tired_count,
  t.home_win_pct_with_rest_advantage,
  t.home_avg_point_diff_with_rest_advantage,
  t.home_with_rest_advantage_count,
  t.away_win_pct_well_rested_vs_tired,
  t.away_avg_point_diff_well_rested_vs_tired,
  t.away_well_rested_vs_tired_count,
  t.away_win_pct_well_rested_vs_moderate,
  t.away_avg_point_diff_well_rested_vs_moderate,
  t.away_well_rested_vs_moderate_count,
  t.away_win_pct_moderate_vs_tired,
  t.away_avg_point_diff_moderate_vs_tired,
  t.away_moderate_vs_tired_count,
  t.away_win_pct_with_rest_advantage,
  t.away_avg_point_diff_with_rest_advantage,
  t.away_with_rest_advantage_count,
  t.is_well_rested_vs_tired,
  t.is_well_rested_vs_moderate,
  t.is_moderate_vs_tired,
  t.is_rest_advantage_scenario,
  t.win_pct_well_rested_vs_tired_diff,
  t.win_pct_well_rested_vs_moderate_diff,
  t.win_pct_moderate_vs_tired_diff,
  t.win_pct_with_rest_advantage_diff,
  -- Rest combination performance
  t.home_win_pct_by_rest_combination,
  t.home_avg_point_diff_by_rest_combination,
  t.home_rest_combination_count,
  t.away_win_pct_by_rest_combination,
  t.away_avg_point_diff_by_rest_combination,
  t.away_rest_combination_count,
  t.rest_combination_win_pct_diff,
  t.rest_combination_point_diff_diff,
  -- Matchup compatibility
  t.pace_difference,
  t.pace_compatibility_score,
  t.home_off_vs_away_def_compatibility,
  t.away_off_vs_home_def_compatibility,
  t.style_matchup_advantage,
  t.net_rtg_difference,
  t.net_rtg_compatibility_score,
  -- Pace context performance
  t.home_fast_pace_win_pct,
  t.home_fast_pace_game_count,
  t.home_fast_pace_avg_point_diff,
  t.home_slow_pace_win_pct,
  t.home_slow_pace_game_count,
  t.home_slow_pace_avg_point_diff,
  t.away_fast_pace_win_pct,
  t.away_fast_pace_game_count,
  t.away_fast_pace_avg_point_diff,
  t.away_slow_pace_win_pct,
  t.away_slow_pace_game_count,
  t.away_slow_pace_avg_point_diff,
  t.fast_pace_win_pct_diff,
  t.fast_pace_avg_point_diff_diff,
  t.slow_pace_win_pct_diff,
  t.slow_pace_avg_point_diff_diff

FROM intermediate.int_momentum_group_basic b
LEFT JOIN intermediate.int_momentum_group_h2h h ON h.game_id = b.game_id
LEFT JOIN intermediate.int_momentum_group_opponent o ON o.game_id = b.game_id
LEFT JOIN intermediate.int_momentum_group_context c ON c.game_id = b.game_id
LEFT JOIN intermediate.int_momentum_group_trends t ON t.game_id = b.game_id
WHERE b.game_date >= @start_ds AND b.game_date < @end_ds;
