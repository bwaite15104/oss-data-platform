gateways:
  local:
    connection:
      type: postgres
      host: postgres  # Use localhost for local, postgres for Docker
      port: 5432
      user: postgres
      password: postgres
      database: nba_analytics
      # Reduce concurrent tasks to avoid race conditions during virtual layer updates
      concurrent_tasks: 1
      # Increase statement timeout for large materializations (30 minutes)
      # Note: PostgreSQL uses milliseconds, but SQLMesh may handle this differently

default_gateway: local

model_defaults:
  dialect: postgres
  start: '2010-10-01'  # Start from 15 years ago to include more historical data for training

# Physical table naming: use hash_md5 so names stay under PostgreSQL's 63-char identifier limit.
# SQLMesh temp tables during plan use schema__model__hash_schema_tmp - keep model short names <= 27 chars.
physical_table_naming_convention: hash_md5

# Physical schema mapping
physical_schema_mapping:
  staging: staging
  intermediate: intermediate
  marts: marts
  features_dev: features_dev
