2026-01-17 17:27:11 +0000 - dagster - DEBUG - __ASSET_JOB - b84cc780-6788-4b3a-ae25-54b16f9c7621 - 870 - LOGS_CAPTURED - Started capturing logs in process (pid: 870).
2026-01-17 17:27:11 +0000 - dagster - DEBUG - __ASSET_JOB - b84cc780-6788-4b3a-ae25-54b16f9c7621 - 870 - nba_teams - STEP_START - Started execution of step "nba_teams".
2026-01-17 17:29:57 +0000 - dagster - ERROR - __ASSET_JOB - b84cc780-6788-4b3a-ae25-54b16f9c7621 - nba_teams - NBA teams ingestion failed: Pipeline execution failed at `step=extract` when processing package with `load_id=1768670831.803806` with exception:

<class 'dlt.extract.exceptions.ResourceExtractionError'>
In processing pipe `teams`: extraction of resource `teams` in `generator` `nba_teams_resource` caused an exception: HTTPSConnectionPool(host='stats.nba.com', port=443): Read timed out. (read timeout=30)
2026-01-17 17:29:57 +0000 - dagster - ERROR - __ASSET_JOB - b84cc780-6788-4b3a-ae25-54b16f9c7621 - 870 - nba_teams - STEP_FAILURE - Execution of step "nba_teams" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "nba_teams"::

dlt.pipeline.exceptions.PipelineStepFailed: Pipeline execution failed at `step=extract` when processing package with `load_id=1768670831.803806` with exception:

<class 'dlt.extract.exceptions.ResourceExtractionError'>
In processing pipe `teams`: extraction of resource `teams` in `generator` `nba_teams_resource` caused an exception: HTTPSConnectionPool(host='stats.nba.com', port=443): Read timed out. (read timeout=30)

Stack Trace:
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/execution/plan/utils.py", line 57, in op_execution_error_boundary
    yield
  File "/usr/local/lib/python3.11/site-packages/dagster/_utils/__init__.py", line 394, in iterate_with_context
    next_output = next(iterator)
                  ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/execution/plan/compute_generator.py", line 135, in _coerce_op_compute_fn_to_iterator
    result = invoke_compute_fn(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/execution/plan/compute_generator.py", line 115, in invoke_compute_fn
    return fn(context, **args_to_pass) if context_arg_provided else fn(**args_to_pass)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/dagster/dagster_home/assets/ingestion/nba.py", line 47, in nba_teams
    load_info = pipeline.run([nba_teams_resource()])
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dlt/pipeline/pipeline.py", line 224, in _wrap
    step_info = f(self, *args, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dlt/pipeline/pipeline.py", line 272, in _wrap
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dlt/pipeline/pipeline.py", line 734, in run
    self.extract(
  File "/usr/local/lib/python3.11/site-packages/dlt/pipeline/pipeline.py", line 224, in _wrap
    step_info = f(self, *args, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dlt/pipeline/pipeline.py", line 178, in _wrap
    rv = f(self, *args, **kwargs)
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dlt/pipeline/pipeline.py", line 164, in _wrap
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dlt/pipeline/pipeline.py", line 272, in _wrap
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dlt/pipeline/pipeline.py", line 493, in extract
    raise PipelineStepFailed(

The above exception was caused by the following exception:
dlt.extract.exceptions.ResourceExtractionError: In processing pipe `teams`: extraction of resource `teams` in `generator` `nba_teams_resource` caused an exception: HTTPSConnectionPool(host='stats.nba.com', port=443): Read timed out. (read timeout=30)

Stack Trace:
  File "/usr/local/lib/python3.11/site-packages/dlt/pipeline/pipeline.py", line 472, in extract
    self._extract_source(
  File "/usr/local/lib/python3.11/site-packages/dlt/pipeline/pipeline.py", line 1331, in _extract_source
    load_id = extract.extract(
              ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dlt/extract/extract.py", line 485, in extract
    self._extract_single_source(
  File "/usr/local/lib/python3.11/site-packages/dlt/extract/extract.py", line 403, in _extract_single_source
    for pipe_item in pipes:
  File "/usr/local/lib/python3.11/site-packages/dlt/extract/pipe_iterator.py", line 158, in __next__
    pipe_item = self._get_source_item()
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dlt/extract/pipe_iterator.py", line 304, in _get_source_item
    raise ResourceExtractionError(pipe.name, gen, str(ex), "generator") from ex

The above exception was caused by the following exception:
requests.exceptions.ReadTimeout: HTTPSConnectionPool(host='stats.nba.com', port=443): Read timed out. (read timeout=30)

Stack Trace:
  File "/usr/local/lib/python3.11/site-packages/dlt/extract/pipe_iterator.py", line 274, in _get_source_item
    pipe_item = next(gen)
                ^^^^^^^^^
  File "/app/ingestion/dlt/pipelines/nba_stats.py", line 183, in nba_teams_resource
    response = requests.get(base_url, params=params, headers=headers, timeout=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dlt/sources/helpers/requests/retry.py", line 213, in <lambda>
    self.get = lambda *a, **kw: self.session.get(*a, **kw)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dlt/sources/helpers/requests/session.py", line 54, in request
    resp = super().request(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dlt/sources/helpers/requests/retry.py", line 131, in <lambda>
    retry_error_callback=lambda state: state.outcome.result(),
                                       ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dlt/sources/helpers/requests/session.py", line 61, in send
    return super().send(request, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 690, in send
    raise ReadTimeout(e, request=request)

The above exception occurred during handling of the following exception:
urllib3.exceptions.ReadTimeoutError: HTTPSConnectionPool(host='stats.nba.com', port=443): Read timed out. (read timeout=30)

Stack Trace:
  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 490, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 536, in _make_request
    self._raise_timeout(err=e, url=url, timeout_value=read_timeout)
  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 367, in _raise_timeout
    raise ReadTimeoutError(

The above exception was caused by the following exception:
TimeoutError: The read operation timed out

Stack Trace:
  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 571, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/http/client.py", line 1395, in getresponse
    response.begin()
  File "/usr/local/lib/python3.11/http/client.py", line 325, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/http/client.py", line 286, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/socket.py", line 718, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/ssl.py", line 1314, in recv_into
    return self.read(nbytes, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/ssl.py", line 1166, in read
    return self._sslobj.read(len, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

